<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>RL Ranks Pro</title>

  <!-- PWA / install -->
  <meta name="theme-color" content="#0b1322" />
  <meta name="color-scheme" content="dark" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <link rel="manifest" href="/site.webmanifest" />
  <link rel="icon" href="/icons/spark.svg" type="image/svg+xml" />
  <link rel="apple-touch-icon" href="/icons/spark-192.png" />

  <!-- Social preview -->
  <meta property="og:title" content="RL Ranks Pro — 2v2 Rank Predictor" />
  <meta property="og:description" content="Enter your starting rank & division → project your path over the next N games." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://rlranks.pro/" />
  <meta property="og:image" content="https://rlranks.pro/og-card.svg" />
  <meta name="twitter:card" content="summary_large_image" />

  <!-- Perf hints -->
  <link rel="preload" as="fetch" href="/ranks/2v2.json" crossorigin="anonymous" />
  <link rel="preload" href="/script.js" as="script" />
  <link rel="preload" href="/style.css" as="style" />

  <!-- Styles -->
  <link rel="stylesheet" href="/style.css" />

  <!-- Inline styles for Ask AI overlay -->
  <style>
    .ai-overlay {
      position: fixed; inset: 0; display: none;
      background:
        radial-gradient(60% 60% at 80% 90%, rgba(255,215,120,.08), transparent 60%),
        radial-gradient(55% 55% at 15% 10%, rgba(106,167,255,.06), transparent 60%),
        rgba(5,10,20,.86);
      -webkit-backdrop-filter: blur(6px);
      backdrop-filter: blur(6px);
      z-index: 2147483500;
    }
    .ai-overlay:target { display: block; }
    .ai-sheet {
      position: absolute; inset: 0; display: grid; place-items: center;
      padding: 24px;
    }
    .ai-card {
      width: min(780px, 92vw); max-height: min(86vh, 720px);
      background: linear-gradient(180deg, rgba(16,26,45,.9), rgba(10,16,28,.9));
      border: 1px solid rgba(255,255,255,.06);
      border-radius: 20px; box-shadow: 0 20px 80px rgba(0,0,0,.45), 0 0 60px rgba(255, 213, 95, .15);
      padding: clamp(16px, 3.2vw, 28px);
      overflow: auto;
    }
    .ai-card h3 { margin: 0 0 8px; font-size: clamp(18px, 3.4vw, 22px); }
    .ai-card p  { margin: 6px 0 0; opacity: .9; }
    .ai-actions {
      display: flex; gap: 10px; margin-top: 16px; flex-wrap: wrap;
    }
    .ai-primary, .ai-ghost {
      border-radius: 12px; padding: 10px 14px; font-weight: 600;
      border: 1px solid transparent; cursor: pointer; text-decoration: none;
      display: inline-flex; align-items: center; justify-content: center;
    }
    .ai-primary {
      background: linear-gradient(180deg, #ffd666, #ffbf3f);
      color: #1b1404; border-color: rgba(0,0,0,.08);
      box-shadow: 0 8px 24px rgba(255,191,63,.25);
    }
    .ai-ghost {
      background: transparent; color: #cbd6ff; border-color: rgba(255,255,255,.12);
    }
    .ai-close { position: absolute; top: 10px; right: 14px; }
    footer.foot { display: none; }
  </style>
</head>
<body>
  <main class="wrap">
    <header class="top">
      <h1>2v2 Rank Predictor</h1>
      <p class="sub">Enter your starting rank &amp; division → project your path over the next N games.</p>
    </header>

    <!-- STEP 1 -->
    <section class="card">
      <h2 class="step">Step 1 · Starting point</h2>
      <div class="grid">
        <label>
          Start Rank
          <select id="rank" aria-label="Start Rank" disabled autocomplete="off">
            <option>Loading…</option>
          </select>
        </label>

        <label>
          Start Division
          <select id="div" aria-label="Start Division" disabled autocomplete="off">
            <option>—</option>
          </select>
          <small>Divisions increase I → IV. SSL has one division.</small>
        </label>

        <label>
          Games to project
          <input id="games" type="number" min="1" max="200" value="50" inputmode="numeric" enterkeyhint="go" autocomplete="off" />
        </label>

        <label>
          Recent Win %
          <input id="win" type="number" min="0" max="100" placeholder="optional" inputmode="decimal" enterkeyhint="go" autocomplete="off" />
          <small>Leave blank to use the model’s base win rate.</small>
        </label>

        <label class="full">
          Win% regression toward 50% as you climb
          <div class="row">
            <input id="regress" type="range" min="0" max="100" value="14" />
            <span id="regressTag" class="tag">14% • gentle</span>
          </div>
          <small>0% = never regresses. 100% = snaps toward 50% very quickly.</small>
        </label>

        <details class="full backup">
          <summary>Advanced · MMR override (optional)</summary>
          <label>
            Exact current 2v2 MMR
            <input id="mmrOverride" type="number" min="-100" max="4000" placeholder="If set, overrides rank/div midpoint" inputmode="numeric" enterkeyhint="go" autocomplete="off" />
          </label>
        </details>

        <label class="full">
          Display name (optional)
          <input id="name" placeholder="Shown in the header only" maxlength="40" enterkeyhint="go" autocomplete="off" />
        </label>
      </div>

      <div class="actions">
        <button id="btnPredict" class="primary" accesskey="p" aria-controls="out" title="Predict (Alt/Option+Shift+P)">Predict</button>
      </div>
    </section>

    <!-- OUTPUT -->
    <section id="out" class="card hide" aria-live="polite" aria-atomic="false">
      <div class="head">
        <h2 id="title">2v2 Doubles</h2>

        <div class="badges">
          <div class="badge">
            <div class="k">Current</div>
            <div class="v" id="currRank">—</div>
            <div class="s"><span id="currMMR">—</span> MMR · <span id="currWR">—</span>% WR</div>
          </div>
          <div class="badge" id="projBadge">
            <div class="k">
              Projected
              <button id="explain" class="ghost tiny" aria-label="Explain">ℹ︎</button>
            </div>
            <div class="v" id="projRank">—</div>
            <div class="s"><span id="projMMR">—</span> MMR · <span id="projWR">—</span>% WR (final)</div>
          </div>
        </div>
      </div>

      <div class="chart">
        <svg id="svg" viewBox="0 0 800 320" preserveAspectRatio="none" aria-label="Projected MMR over games" role="img"></svg>
        <div class="axis" aria-hidden="true">
          <span id="x0">0</span>
          <span id="xMid">—</span>
          <span id="xMax">—</span>
        </div>
      </div>

      <!-- LADDER -->
      <div class="ladder" aria-label="Rank jump">
        <div class="rank-tile current">
          <div class="rank-name" id="tileCurrName">—</div>
          <div class="rank-range" id="tileCurrRange">—</div>
        </div>

        <div class="jump">
          <div class="arrow" id="ladderArrow"></div>
          <div class="delta" id="mmrDelta">+0</div>
        </div>

        <div class="rank-tile projected" id="tileProjected">
          <div class="rank-name" id="tileProjName">—</div>
          <div class="rank-range" id="tileProjRange">—</div>
        </div>
      </div>
    </section>

    <footer class="foot"></footer>
  </main>

  <!-- Ask AI FAB -->
  <a id="aiBtn" href="#ai-overlay" class="ai-fab" role="button" title="Ask AI" accesskey="a" aria-label="Ask AI">
    <span class="ai-glow" aria-hidden="true"></span>
    <span>Ask&nbsp;AI</span>
  </a>

  <!-- Ask AI Overlay -->
  <div id="ai-overlay" class="ai-overlay" aria-modal="true" role="dialog">
    <div class="ai-sheet">
      <a href="#" class="ai-ghost ai-close" aria-label="Close">Close</a>
      <div class="ai-card">
        <h3>Ask AI (Not Live Yet)</h3>
        <p>This is gonna be a full screen assistant that reacts to your real life chaos.</p>
        <p style="opacity:.75;margin-top:10px">Example prompts:</p>
        <ul style="margin:6px 0 0 18px; opacity:.9">
          <li>New monitor slight headache can I keep D2?</li>
          <li>Three hours of sleep and an energy drink am I still holding this rank?</li>
          <li>Teammates fighting in voice chat what happens to my climb?</li>
        </ul>
        <div class="ai-actions">
          <a href="#" class="ai-primary" aria-label="Close and return">Lock it in</a>
          <a href="#" class="ai-ghost" aria-label="Close">Close</a>
        </div>
      </div>
    </div>
  </div>

  <div id="tooltip" class="tooltip hide" role="status" aria-live="polite"></div>

  <noscript>
    <div class="card" role="alert" style="max-width:960px;margin:12px auto">
      JavaScript is required to run the projection and chart. Please enable JavaScript.
    </div>
  </noscript>

  <!-- Scripts -->
  <script src="/script.js"></script>
  <script src="/sitefrontend/monetize/monetize.js"></script>
  <script src="/sw-register.js"></script>
</body>
</html>